<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Using File#fnmatch? to mimick Dir#glob</title>
        <meta name="viewport" content="initial-scale=1.0">
        <link href='/assets/global-4f95d28fa671039d795aecbacd54a16d.css' rel='stylesheet' type='text/css' />

    </head>
    <body>
      <div class="container">
        <header>
          <h1>Jean-Philippe Doyle (j15e)</h1>
          <h2>Developer, homebrewer & more</h2>
          <nav>
            <a href="/">articles</a></h1>
            <a class="extra" target="_blank" href="http://github.com/j15e/">@github</a>
            <a class="extra" target="_blank" href="http://twitter.com/j15e/">@twitter</a>
          </nav>
        </header>

            <h2>Using File#fnmatch? to mimick Dir#glob</h2>
<p class="meta">22 Jun 2013</p>

<div id="post" class="hyphenate text" lang="en">
<p>Someone opened an <a href="https://github.com/rstacruz/sinatra-assetpack/issues/108">issue</a> on sinatra-assetpack recently regarding
unexpected behaviour of our Dir#glob-like feature to match source files in a
given assets package.</p>

<p>I found out that <a href="http://www.ruby-doc.org/core-2.0/File.html#method-c-fnmatch-3F">File#fnmatch?</a> method we use to reproduce a glob-like matching
on assets soruces is not behaving exactly the same way a Dir#glob would
under certain conditions.</p>

<p>There was a very tiny hint in the documentation :</p>

<blockquote><p>The pattern is not a regular expression; instead it follows rules <strong>similar</strong>
to shell filename globbing.</p></blockquote>

<p>Specifically in this case, <code>fnmatch?</code> will not match starting <code>/</code> or <code>.</code>
with subfolders <code>/**/</code> matching.</p>

<p>But you can specify an option flag to enable matching of those cases
(likely what you expect in most cases) :</p>

<div class="highlight"><pre><code class="ruby"><span class="no">File</span><span class="o">.</span><span class="n">fnmatch?</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="ss">File</span><span class="p">:</span><span class="ss">:FNM_PATHNAME</span> <span class="o">|</span> <span class="ss">File</span><span class="p">:</span><span class="ss">:FNM_DOTMATCH</span><span class="p">)</span>
</code></pre></div>




</div>


        <footer>
          <a target="_blank" href="https://github.com/j15e/j15e.github.io">View source (⌥⌘U)</a>
        </footer>
      </div>
    </body>
</html>
