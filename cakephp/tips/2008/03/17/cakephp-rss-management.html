<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>CakePHP ; dynamic RSS management</title>
        <meta name="viewport" content="initial-scale=1.0">
        <link href='/assets/global-4f95d28fa671039d795aecbacd54a16d.css' rel='stylesheet' type='text/css' />

    </head>
    <body>
      <div class="container">
        <header>
          <h1>Jean-Philippe Doyle (j15e)</h1>
          <h2>Developer, homebrewer & more</h2>
          <nav>
            <a href="/">articles</a></h1>
            <a class="extra" target="_blank" href="http://github.com/j15e/">@github</a>
            <a class="extra" target="_blank" href="http://twitter.com/j15e/">@twitter</a>
          </nav>
        </header>

            <h2>CakePHP ; dynamic RSS management</h2>
<p class="meta">17 Mar 2008</p>

<div id="post" class="hyphenate text" lang="en">
<p>How to deal with multiple dynamic RSS feeds?</p>

<p>I used 2 objects to manage my RSS, one to store them (component) and one to help displaying them (helper).</p>

<ol>
    <li>Create a component to manage them</li>
    <li>Create an helper to display them (meta-tags and HTML links)</li>
</ol>


<h3>Component</h3>


<p>Let's create a simple component that will allow us to add RSS within our controllers.</p>

<pre><code>class FeedsListComponent extends Object {

    private $feeds = array();

    function startup() {
    }

    function add($title,$url,$link=true) {
       $this-&gt;feeds[] = array($title,$url,$link);
    }

    function feeds() {
       return $this-&gt;feeds;
    }
}
</code></pre>

<p>Exemple of usage :</p>

<pre><code>$this-&gt;FeedsList-&gt;add('All news','/news/.rss');
$this-&gt;FeedsList-&gt;add('Canada news','/news/canada.rss');
</code></pre>

<p>The third argument is optional and specify whether or not the link should be automatically listed on the page.</p>

<p>Now you may either</p>

<ul>
    <li>Add feeds that should display on all pages (general ones) directly in the app controller feeds</li>
    <li>Add feeds that you wish to display in specific controllers / actions in those</li>
</ul>


<p>You may add the FeedsList component in the app controller so you can access it from all controllers.</p>

<h3>Helper</h3>


<p>An helpter will help display feeds <em>metas</em> and html <em>links</em>.</p>

<pre><code>class FeedsListHelper extends AppHelper {

    var $helpers = array('Html');

    function metas($feeds){
        $meta='';
        foreach($feeds as $feed)
            $meta .= $this-&gt;Html-&gt;meta('rss', $feed[1], array('title' =&gt; $feed[0]));
        return $meta;
    }

    function links($feeds){
        $links='';
        foreach($feeds as $feed) if($feed[2]) $links .= '
            &lt;div class="rssFeed""&gt;
            &lt;a href="'.$feed[1].'" title="'.$feed[0].'"&gt;
            &lt;img src="/img/feed-icon-14x14.png" alt="'.$feed[0].'" /&gt;&lt;/a&gt;
            &lt;a href="'.$feed[1].'" title="'.$feed[0].'"&gt;'.$feed[0].'&lt;/a&gt;
            &lt;/div&gt;';
        return $links;
    }
}
</code></pre>

<h3>View</h3>


<p>You can then use the 2 helper's functions in your layout/views, providing the FeedList array :</p>

<pre><code>echo $feedList-&gt;metas($feeds);
echo $feedList-&gt;links($feeds);
</code></pre>

<p>or directly writing a feed title and url :</p>

<pre><code>echo $feedList-&gt;links(array(array('All news','/news.rss',true)));
</code></pre>

</div>


        <footer>
          <a target="_blank" href="https://github.com/j15e/j15e.github.io">View source (⌥⌘U)</a>
        </footer>
      </div>
    </body>
</html>
